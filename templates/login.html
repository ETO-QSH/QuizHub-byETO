<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>登录</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="/static/style.css" rel="stylesheet">
</head>
<body class="bg-light d-flex align-items-center justify-content-center" style="height:100vh;">
  <div class="card shadow-sm" style="min-width:360px;">
    <div class="card-body">
      <div class="card-title mb-3 text-center">
        <div style="font-size:1.6rem; font-weight:700; line-height:1.1;">『毛概 & 马原』</div>
        <div style="font-size:0.95rem; color:var(--bs-gray-600); margin-top:4px;">客观题库刷题系统 - byETO</div>
      </div>
      {% if error %}<div class="alert alert-danger">{{error}}</div>{% endif %}
      <form method="post" class="mx-auto" style="max-width:360px;">
        <div class="mb-3">
          <label for="username" class="form-label">用户名</label>
          <input id="username" name="username" class="form-control" required pattern="[A-Za-z0-9]+" />
        </div>

        <div class="mb-3">
          <label for="password" class="form-label">密码</label>
          <input id="password" name="password" type="password" class="form-control" required pattern="[A-Za-z0-9]+" />
        </div>

        <div class="d-flex gap-2">
          <button type="submit" name="course" value="maogai" class="btn btn-primary flex-fill">毛概刷题</button>
          <button type="submit" name="course" value="mayuan" class="btn btn-secondary flex-fill">马原刷题</button>
        </div>
      </form>
      <hr>
      <div class="small text-muted">用户名和密码仅允许字母和数字。首次使用会自动注册并登录；若用户名已存在但密码错误，会提示。</div>
    </div>
  </div>

  <div class="modal fade" id="announceModal" tabindex="-1" aria-labelledby="announceTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="announceTitle" class="modal-title w-100 text-center" role="heading" aria-level="1">公告</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="关闭"></button>
        </div>
        <div class="modal-body">
          <p class="fw-bold mb-2">重要通知（请务必阅读）：</p>
          <ul>
            <li>本系统将于本周末维护，预计停机 2 小时。⏰</li>
            <li>请提前保存未提交的答题记录，维护期间无法访问。💾</li>
            <li>新功能上线：支持解析显示开关，详见 <a href="https://example.com" target="_blank" rel="noopener">更新说明</a>。🔗</li>
            <li>如有问题，请联系管理员：<strong>admin@example.com</strong>。✉️</li>
          </ul>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 引入 Bootstrap JS 并自动触发模态（不会影响现有页面结构） -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    (function(){
      document.addEventListener('DOMContentLoaded', function(){
        var m = document.getElementById('announceModal');
        if(!m) return;
        var modal = new bootstrap.Modal(m, {});
        // 若只想首次显示一次，取消下面注释并使用 localStorage 控制：
        // if(!localStorage.getItem('seen_announce_v1')){ modal.show(); localStorage.setItem('seen_announce_v1','1'); }
        // 默认：每次加载登录页都弹出
        modal.show();
      });
    })();
  </script>
</body>
</html>
